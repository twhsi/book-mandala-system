<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>曼陀羅專案管理系統 - 固定網址版</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Microsoft JhengHei', 'PingFang SC', 'Apple LiGothic Medium', sans-serif; }
        .mandala-grid { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 8px; 
            aspect-ratio: 1;
            max-width: 480px;
            width: 100%;
        }
        .grid-cell { 
            background: #f8fafc; 
            border: 2px solid #e2e8f0; 
            border-radius: 8px; 
            padding: 8px; 
            display: flex; 
            flex-direction: column;
            min-height: 100px;
            position: relative;
        }
        .grid-cell:hover { background: #f1f5f9; }
        .cell-label { 
            font-size: 12px; 
            font-weight: 700; 
            margin-bottom: 4px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            width: 20px; 
            height: 20px; 
            border-radius: 50%; 
            color: white;
            flex-shrink: 0;
        }
        .cell-content { 
            flex: 1; 
            resize: none; 
            border: none; 
            outline: none; 
            background: transparent; 
            font-size: 12px; 
            line-height: 1.4;
            width: 100%;
        }
        .center-cell { background: #e2e8f0; border-color: #94a3b8; }
        .center-label { background: #64748b; }
        .ring-cell { background: #f1f5f9; }
        .ring-label { background: #3b82f6; }
        .detail-cell { background: #f8fafc; }
        .detail-label { background: #6b7280; }
        
        /* 章節顏色 */
        .chapter-26 { --chapter-color: #3b82f6; }
        .chapter-27 { --chapter-color: #10b981; }
        .chapter-28 { --chapter-color: #f59e0b; }
        .chapter-29 { --chapter-color: #8b5cf6; }
        
        .sidebar { 
            width: 280px; 
            height: 100vh; 
            overflow-y: auto; 
            transition: margin-left 0.3s ease;
        }
        .sidebar.hidden { margin-left: -280px; }
        .main-content { transition: margin-left 0.3s ease; }
        .main-content.expanded { margin-left: 0; }
        
        .project-item { 
            padding: 8px 12px; 
            margin: 2px 0; 
            border-radius: 6px; 
            cursor: pointer; 
            transition: all 0.2s;
        }
        .project-item:hover { background: #f1f5f9; }
        .project-item.active { background: #3b82f6; color: white; }
        
        .sync-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-left: 8px;
        }
        .sync-status.synced { background: #10b981; }
        .sync-status.syncing { background: #f59e0b; animation: pulse 2s infinite; }
        .sync-status.error { background: #ef4444; }
        .sync-status.offline { background: #6b7280; }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @media (max-width: 1024px) {
            .sidebar { width: 240px; }
            .sidebar.hidden { margin-left: -240px; }
            .mandala-grid { max-width: 400px; }
            .grid-cell { min-height: 80px; }
        }
        
        @media (max-width: 768px) {
            .sidebar { width: 100%; position: absolute; z-index: 50; }
            .sidebar.hidden { margin-left: -100%; }
            .main-content { margin-left: 0 !important; }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- 固定網址部署說明 Modal -->
    <div id="deployModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-96 overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold">🔗 固定網址部署方案</h3>
                <button onclick="closeDeployModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="space-y-4 text-sm">
                <div class="p-4 bg-blue-50 rounded-lg">
                    <h4 class="font-bold text-blue-800 mb-2">🚀 推薦方案：AI Drive部署</h4>
                    <p>點擊下方「部署到AI Drive」按鈕，獲得永久固定網址</p>
                </div>
                <div class="p-4 bg-green-50 rounded-lg">
                    <h4 class="font-bold text-green-800 mb-2">📂 GitHub Pages部署</h4>
                    <ol class="list-decimal ml-4 space-y-1">
                        <li>下載此HTML檔案</li>
                        <li>上傳到GitHub Repository</li>
                        <li>啟用GitHub Pages</li>
                        <li>獲得如：yourname.github.io/mandala 的固定網址</li>
                    </ol>
                </div>
                <div class="p-4 bg-yellow-50 rounded-lg">
                    <h4 class="font-bold text-yellow-800 mb-2">🏠 自建伺服器部署</h4>
                    <p>下載HTML檔案，上傳到您的虛擬主機或伺服器</p>
                </div>
            </div>
            <div class="mt-6 flex gap-3">
                <button onclick="downloadHTML()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                    <i class="fas fa-download mr-2"></i>下載HTML檔案
                </button>
                <button onclick="closeDeployModal()" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">
                    關閉
                </button>
            </div>
        </div>
    </div>

    <div class="flex h-screen">
        <!-- Sidebar -->
        <div id="sidebar" class="sidebar bg-white shadow-lg border-r border-gray-200">
            <!-- Header -->
            <div class="p-4 border-b border-gray-200">
                <div class="flex items-center justify-between mb-3">
                    <h2 class="text-lg font-bold text-gray-800">曼陀羅專案管理</h2>
                    <button onclick="toggleSidebar()" class="lg:hidden">
                        <i class="fas fa-times text-gray-500"></i>
                    </button>
                </div>
                
                <!-- GitHub 設定狀態 -->
                <div id="githubStatus" class="text-xs text-gray-600 mb-2">
                    <i class="fas fa-github mr-1"></i>
                    <span id="githubStatusText">未連接GitHub</span>
                    <span id="githubSyncStatus" class="sync-status offline"></span>
                </div>
                
                <!-- 快速搜尋 -->
                <div class="relative">
                    <input type="text" id="projectSearch" placeholder="搜尋專案 (如: 2.6.1 或 目標)" 
                           class="w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                    <i class="fas fa-search absolute right-3 top-2.5 text-gray-400"></i>
                </div>
            </div>
            
            <!-- 專案列表 -->
            <div class="flex-1 overflow-y-auto p-2">
                <div id="projectList">
                    <!-- 2.6 系列 -->
                    <div class="mb-4">
                        <div class="flex items-center justify-between px-2 py-1 text-sm font-semibold text-blue-800 bg-blue-50 rounded">
                            <span><i class="fas fa-folder mr-2"></i>2.6 系列</span>
                            <span class="text-xs">7項</span>
                        </div>
                        <div class="ml-4 mt-1">
                            <div class="project-item chapter-26" data-project="2.6.1">
                                <i class="fas fa-bullseye mr-2"></i>2.6.1 目標
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-26" data-project="2.6.2">
                                <i class="fas fa-exclamation-triangle mr-2"></i>2.6.2 阻礙
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-26" data-project="2.6.3">
                                <i class="fas fa-dumbbell mr-2"></i>2.6.3 努力
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-26" data-project="2.6.4">
                                <i class="fas fa-check-circle mr-2"></i>2.6.4 結果
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-26" data-project="2.6.5">
                                <i class="fas fa-bolt mr-2"></i>2.6.5 意外
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-26" data-project="2.6.6">
                                <i class="fas fa-exchange-alt mr-2"></i>2.6.6 轉彎
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-26" data-project="2.6.7">
                                <i class="fas fa-flag-checkered mr-2"></i>2.6.7 結局
                                <span class="sync-status offline"></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 2.7 系列 -->
                    <div class="mb-4">
                        <div class="flex items-center justify-between px-2 py-1 text-sm font-semibold text-green-800 bg-green-50 rounded">
                            <span><i class="fas fa-folder mr-2"></i>2.7 系列</span>
                            <span class="text-xs">7項</span>
                        </div>
                        <div class="ml-4 mt-1">
                            <div class="project-item chapter-27" data-project="2.7.1">
                                <i class="fas fa-bullseye mr-2"></i>2.7.1 目標
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-27" data-project="2.7.2">
                                <i class="fas fa-exclamation-triangle mr-2"></i>2.7.2 阻礙
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-27" data-project="2.7.3">
                                <i class="fas fa-dumbbell mr-2"></i>2.7.3 努力
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-27" data-project="2.7.4">
                                <i class="fas fa-check-circle mr-2"></i>2.7.4 結果
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-27" data-project="2.7.5">
                                <i class="fas fa-bolt mr-2"></i>2.7.5 意外
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-27" data-project="2.7.6">
                                <i class="fas fa-exchange-alt mr-2"></i>2.7.6 轉彎
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-27" data-project="2.7.7">
                                <i class="fas fa-flag-checkered mr-2"></i>2.7.7 結局
                                <span class="sync-status offline"></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 2.8 系列 -->
                    <div class="mb-4">
                        <div class="flex items-center justify-between px-2 py-1 text-sm font-semibold text-yellow-800 bg-yellow-50 rounded">
                            <span><i class="fas fa-folder mr-2"></i>2.8 系列</span>
                            <span class="text-xs">7項</span>
                        </div>
                        <div class="ml-4 mt-1">
                            <div class="project-item chapter-28" data-project="2.8.1">
                                <i class="fas fa-bullseye mr-2"></i>2.8.1 目標
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-28" data-project="2.8.2">
                                <i class="fas fa-exclamation-triangle mr-2"></i>2.8.2 阻礙
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-28" data-project="2.8.3">
                                <i class="fas fa-dumbbell mr-2"></i>2.8.3 努力
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-28" data-project="2.8.4">
                                <i class="fas fa-check-circle mr-2"></i>2.8.4 結果
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-28" data-project="2.8.5">
                                <i class="fas fa-bolt mr-2"></i>2.8.5 意外
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-28" data-project="2.8.6">
                                <i class="fas fa-exchange-alt mr-2"></i>2.8.6 轉彎
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-28" data-project="2.8.7">
                                <i class="fas fa-flag-checkered mr-2"></i>2.8.7 結局
                                <span class="sync-status offline"></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 2.9 系列 -->
                    <div class="mb-4">
                        <div class="flex items-center justify-between px-2 py-1 text-sm font-semibold text-purple-800 bg-purple-50 rounded">
                            <span><i class="fas fa-folder mr-2"></i>2.9 系列</span>
                            <span class="text-xs">7項</span>
                        </div>
                        <div class="ml-4 mt-1">
                            <div class="project-item chapter-29" data-project="2.9.1">
                                <i class="fas fa-bullseye mr-2"></i>2.9.1 目標
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-29" data-project="2.9.2">
                                <i class="fas fa-exclamation-triangle mr-2"></i>2.9.2 阻礙
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-29" data-project="2.9.3">
                                <i class="fas fa-dumbbell mr-2"></i>2.9.3 努力
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-29" data-project="2.9.4">
                                <i class="fas fa-check-circle mr-2"></i>2.9.4 結果
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-29" data-project="2.9.5">
                                <i class="fas fa-bolt mr-2"></i>2.9.5 意外
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-29" data-project="2.9.6">
                                <i class="fas fa-exchange-alt mr-2"></i>2.9.6 轉彎
                                <span class="sync-status offline"></span>
                            </div>
                            <div class="project-item chapter-29" data-project="2.9.7">
                                <i class="fas fa-flag-checkered mr-2"></i>2.9.7 結局
                                <span class="sync-status offline"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- GitHub 設定按鈕 -->
            <div class="p-4 border-t border-gray-200">
                <button onclick="showGitHubSetup()" class="w-full bg-gray-800 text-white py-2 px-4 rounded-md text-sm hover:bg-gray-700 transition-colors">
                    <i class="fab fa-github mr-2"></i>GitHub 雲端設定
                </button>
            </div>
        </div>
        
        <!-- Main Content -->
        <div id="mainContent" class="main-content flex-1 flex flex-col ml-0 lg:ml-280">
            <!-- Top Bar -->
            <div class="bg-white shadow-sm border-b border-gray-200 px-4 py-3">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-4">
                        <button onclick="toggleSidebar()" class="lg:hidden">
                            <i class="fas fa-bars text-gray-600"></i>
                        </button>
                        
                        <!-- 專案選擇器 -->
                        <select id="projectSelector" class="text-lg font-semibold text-gray-800 border-none bg-transparent focus:outline-none cursor-pointer">
                            <option value="">選擇專案...</option>
                        </select>
                        
                        <!-- 麵包屑 -->
                        <div id="breadcrumb" class="text-sm text-gray-500 hidden md:block"></div>
                    </div>
                    
                    <div class="flex items-center gap-2">
                        <!-- 同步狀態指示 -->
                        <div id="syncIndicator" class="flex items-center text-sm text-gray-600">
                            <span id="syncStatusIcon" class="sync-status offline mr-2"></span>
                            <span id="syncStatusText">離線</span>
                        </div>
                        
                        <!-- 操作按鈕 -->
                        <div class="flex gap-2">
                            <button onclick="saveProject()" class="bg-blue-500 text-white px-3 py-1.5 rounded text-sm hover:bg-blue-600 transition-colors">
                                <i class="fas fa-save mr-1"></i>儲存
                            </button>
                            <button onclick="loadProject()" class="bg-green-500 text-white px-3 py-1.5 rounded text-sm hover:bg-green-600 transition-colors">
                                <i class="fas fa-undo mr-1"></i>回覆
                            </button>
                            <button onclick="exportCurrentOPML()" class="bg-purple-500 text-white px-3 py-1.5 rounded text-sm hover:bg-purple-600 transition-colors">
                                <i class="fas fa-download mr-1"></i>匯出
                            </button>
                            <button onclick="importOPML()" class="bg-yellow-500 text-white px-3 py-1.5 rounded text-sm hover:bg-yellow-600 transition-colors">
                                <i class="fas fa-upload mr-1"></i>匯入
                            </button>
                            <button onclick="showDeployModal()" class="bg-red-500 text-white px-3 py-1.5 rounded text-sm hover:bg-red-600 transition-colors">
                                <i class="fas fa-link mr-1"></i>固定網址
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 專案內容區 -->
            <div class="flex-1 p-6 overflow-auto">
                <div id="welcomeScreen" class="text-center py-20">
                    <i class="fas fa-th text-6xl text-gray-300 mb-6"></i>
                    <h2 class="text-2xl font-bold text-gray-600 mb-4">歡迎使用曼陀羅專案管理系統</h2>
                    <p class="text-gray-500 mb-6">請從左側選擇一個專案開始編輯</p>
                    <div class="space-y-2 text-sm text-gray-400">
                        <p>💡 提示：設定GitHub Token以啟用雲端同步</p>
                        <p>🔗 點擊右上角「固定網址」了解部署方案</p>
                    </div>
                </div>
                
                <div id="mandalaEditor" class="hidden">
                    <div class="flex items-center justify-between mb-6">
                        <div>
                            <h1 id="projectTitle" class="text-2xl font-bold text-gray-800"></h1>
                            <p id="projectSubtitle" class="text-gray-600"></p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="clearCurrentLevel()" class="bg-orange-500 text-white px-3 py-1.5 rounded text-sm hover:bg-orange-600">
                                <i class="fas fa-eraser mr-1"></i>清除當前層
                            </button>
                            <button onclick="clearEntireMandala()" class="bg-red-500 text-white px-3 py-1.5 rounded text-sm hover:bg-red-600">
                                <i class="fas fa-trash mr-1"></i>清除整個曼陀羅
                            </button>
                        </div>
                    </div>
                    
                    <!-- 返回按鈕 -->
                    <button id="backButton" onclick="goBackToLevel1()" class="mb-4 bg-gray-500 text-white px-4 py-2 rounded text-sm hover:bg-gray-600 hidden">
                        <i class="fas fa-arrow-left mr-2"></i>返回第一層
                    </button>
                    
                    <!-- 九宮格 -->
                    <div class="flex justify-center">
                        <div id="mandalaGrid" class="mandala-grid">
                            <!-- 九宮格內容將通過 JavaScript 生成 -->
                        </div>
                    </div>
                    
                    <!-- 導航提示 -->
                    <div id="navigationInfo" class="mt-6 p-4 bg-blue-50 rounded-lg text-center text-sm text-blue-800">
                        點擊 A、B、C、D、E、F、G、H 進入第二層九宮格編輯細節內容
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- GitHub 設定 Modal -->
    <div id="githubModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center hidden">
        <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
            <h3 class="text-lg font-bold mb-4">GitHub 雲端設定</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">GitHub Personal Access Token</label>
                    <input type="password" id="githubToken" placeholder="ghp_xxxxxxxxxxxx" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500">
                    <p class="text-xs text-gray-500 mt-1">需要 'gist' 權限</p>
                </div>
                <div class="flex gap-3">
                    <button onclick="connectGitHub()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 flex-1">
                        連接 GitHub
                    </button>
                    <button onclick="closeGitHubModal()" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">
                        取消
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 檔案匯入 -->
    <input type="file" id="fileInput" accept=".opml,.xml" style="display: none;" onchange="handleFileImport(event)">

    <script>
        // 全域變數
        let currentProject = null;
        let currentLevel = 1; // 1=第一層, 2=第二層
        let currentSection = null; // A-H
        let githubToken = localStorage.getItem('github_token') || '';
        let projectData = {};
        let sidebarVisible = window.innerWidth >= 1024;
        
        // 專案配置
        const PROJECT_CONFIG = {
            '2.6.1': { name: '目標', chapter: '2.6', color: 'blue' },
            '2.6.2': { name: '阻礙', chapter: '2.6', color: 'blue' },
            '2.6.3': { name: '努力', chapter: '2.6', color: 'blue' },
            '2.6.4': { name: '結果', chapter: '2.6', color: 'blue' },
            '2.6.5': { name: '意外', chapter: '2.6', color: 'blue' },
            '2.6.6': { name: '轉彎', chapter: '2.6', color: 'blue' },
            '2.6.7': { name: '結局', chapter: '2.6', color: 'blue' },
            '2.7.1': { name: '目標', chapter: '2.7', color: 'green' },
            '2.7.2': { name: '阻礙', chapter: '2.7', color: 'green' },
            '2.7.3': { name: '努力', chapter: '2.7', color: 'green' },
            '2.7.4': { name: '結果', chapter: '2.7', color: 'green' },
            '2.7.5': { name: '意外', chapter: '2.7', color: 'green' },
            '2.7.6': { name: '轉彎', chapter: '2.7', color: 'green' },
            '2.7.7': { name: '結局', chapter: '2.7', color: 'green' },
            '2.8.1': { name: '目標', chapter: '2.8', color: 'yellow' },
            '2.8.2': { name: '阻礙', chapter: '2.8', color: 'yellow' },
            '2.8.3': { name: '努力', chapter: '2.8', color: 'yellow' },
            '2.8.4': { name: '結果', chapter: '2.8', color: 'yellow' },
            '2.8.5': { name: '意外', chapter: '2.8', color: 'yellow' },
            '2.8.6': { name: '轉彎', chapter: '2.8', color: 'yellow' },
            '2.8.7': { name: '結局', chapter: '2.8', color: 'yellow' },
            '2.9.1': { name: '目標', chapter: '2.9', color: 'purple' },
            '2.9.2': { name: '阻礙', chapter: '2.9', color: 'purple' },
            '2.9.3': { name: '努力', chapter: '2.9', color: 'purple' },
            '2.9.4': { name: '結果', chapter: '2.9', color: 'purple' },
            '2.9.5': { name: '意外', chapter: '2.9', color: 'purple' },
            '2.9.6': { name: '轉彎', chapter: '2.9', color: 'purple' },
            '2.9.7': { name: '結局', chapter: '2.9', color: 'purple' }
        };
        
        // 九宮格布局順序
        const LEVEL1_ORDER = ['F', 'C', 'G', 'B', 'CENTER', 'D', 'E', 'A', 'H'];
        const LEVEL2_ORDER = ['6', '3', '7', '2', 'CENTER', '4', '5', '1', '8'];
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            updateSidebarVisibility();
            checkGitHubConnection();
            loadProjectsFromLocalStorage();
            setupRouting();
            setupProjectSelector();
            setupSearch();
        });
        
        // 路由系統
        function setupRouting() {
            const hash = window.location.hash;
            if (hash.startsWith('#/mandala/')) {
                const projectId = hash.replace('#/mandala/', '');
                if (PROJECT_CONFIG[projectId]) {
                    selectProject(projectId);
                }
            }
            
            window.addEventListener('hashchange', () => {
                const hash = window.location.hash;
                if (hash.startsWith('#/mandala/')) {
                    const projectId = hash.replace('#/mandala/', '');
                    if (PROJECT_CONFIG[projectId]) {
                        selectProject(projectId);
                    }
                }
            });
        }
        
        // 初始化應用
        function initializeApp() {
            // 初始化專案數據結構
            Object.keys(PROJECT_CONFIG).forEach(projectId => {
                if (!projectData[projectId]) {
                    projectData[projectId] = createEmptyMandala();
                }
            });
            
            // 設置項目點擊事件
            document.querySelectorAll('.project-item').forEach(item => {
                item.addEventListener('click', () => {
                    const projectId = item.getAttribute('data-project');
                    selectProject(projectId);
                });
            });
            
            // 響應式處理
            window.addEventListener('resize', updateSidebarVisibility);
        }
        
        // 創建空的曼陀羅數據結構
        function createEmptyMandala() {
            const mandala = {
                center: { content: '' },
                sections: {}
            };
            
            ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'].forEach(letter => {
                mandala.sections[letter] = {
                    center: { content: '' },
                    details: {}
                };
                
                ['1', '2', '3', '4', '5', '6', '7', '8'].forEach(num => {
                    mandala.sections[letter].details[num] = { content: '' };
                });
            });
            
            return mandala;
        }
        
        // 選擇專案
        function selectProject(projectId) {
            if (!PROJECT_CONFIG[projectId]) return;
            
            currentProject = projectId;
            currentLevel = 1;
            currentSection = null;
            
            // 更新URL
            window.location.hash = `/mandala/${projectId}`;
            
            // 更新UI
            updateActiveProject();
            showMandalaEditor();
            renderMandala();
            updateBreadcrumb();
            
            // 從雲端載入資料
            loadProjectFromCloud(projectId);
        }
        
        // 更新專案選擇器
        function setupProjectSelector() {
            const selector = document.getElementById('projectSelector');
            selector.innerHTML = '<option value="">選擇專案...</option>';
            
            Object.keys(PROJECT_CONFIG).forEach(projectId => {
                const config = PROJECT_CONFIG[projectId];
                const option = document.createElement('option');
                option.value = projectId;
                option.textContent = `${projectId} ${config.name}`;
                selector.appendChild(option);
            });
            
            selector.addEventListener('change', (e) => {
                if (e.target.value) {
                    selectProject(e.target.value);
                }
            });
        }
        
        // 搜尋功能
        function setupSearch() {
            const searchInput = document.getElementById('projectSearch');
            searchInput.addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase();
                document.querySelectorAll('.project-item').forEach(item => {
                    const text = item.textContent.toLowerCase();
                    const parent = item.closest('.mb-4');
                    if (text.includes(query)) {
                        item.style.display = 'block';
                        parent.style.display = 'block';
                    } else {
                        item.style.display = 'none';
                    }
                });
                
                // 如果沒有搜尋內容，顯示所有項目
                if (!query) {
                    document.querySelectorAll('.project-item').forEach(item => {
                        item.style.display = 'block';
                    });
                    document.querySelectorAll('.mb-4').forEach(section => {
                        section.style.display = 'block';
                    });
                }
            });
        }
        
        // 更新活躍專案
        function updateActiveProject() {
            document.querySelectorAll('.project-item').forEach(item => {
                item.classList.remove('active');
            });
            
            if (currentProject) {
                const activeItem = document.querySelector(`[data-project="${currentProject}"]`);
                if (activeItem) {
                    activeItem.classList.add('active');
                }
                
                // 更新專案選擇器
                document.getElementById('projectSelector').value = currentProject;
            }
        }
        
        // 顯示曼陀羅編輯器
        function showMandalaEditor() {
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('mandalaEditor').classList.remove('hidden');
            
            const config = PROJECT_CONFIG[currentProject];
            document.getElementById('projectTitle').textContent = `${currentProject} ${config.name}`;
            document.getElementById('projectSubtitle').textContent = `${config.chapter} 系列`;
        }
        
        // 渲染曼陀羅
        function renderMandala() {
            const grid = document.getElementById('mandalaGrid');
            grid.innerHTML = '';
            
            if (currentLevel === 1) {
                renderLevel1();
            } else {
                renderLevel2();
            }
        }
        
        // 渲染第一層
        function renderLevel1() {
            const grid = document.getElementById('mandalaGrid');
            document.getElementById('backButton').classList.add('hidden');
            document.getElementById('navigationInfo').textContent = '點擊 A、B、C、D、E、F、G、H 進入第二層九宮格編輯細節內容';
            
            LEVEL1_ORDER.forEach(pos => {
                const cell = document.createElement('div');
                
                if (pos === 'CENTER') {
                    cell.className = 'grid-cell center-cell';
                    const content = projectData[currentProject]?.center?.content || '';
                    cell.innerHTML = `
                        <div class="cell-label center-label">中心</div>
                        <textarea class="cell-content" placeholder="主中心內容..." 
                                  onchange="updateContent('center', '', this.value)">${content}</textarea>
                    `;
                } else {
                    cell.className = 'grid-cell ring-cell cursor-pointer';
                    const sectionData = projectData[currentProject]?.sections?.[pos];
                    const content = sectionData?.center?.content || '';
                    cell.innerHTML = `
                        <div class="cell-label ring-label">${pos}</div>
                        <textarea class="cell-content" placeholder="${pos} 區域中心..." 
                                  onchange="updateContent('section', '${pos}', this.value)">${content}</textarea>
                    `;
                    
                    cell.addEventListener('click', (e) => {
                        if (e.target.classList.contains('cell-label')) {
                            enterLevel2(pos);
                        }
                    });
                }
                
                grid.appendChild(cell);
            });
        }
        
        // 渲染第二層
        function renderLevel2() {
            const grid = document.getElementById('mandalaGrid');
            document.getElementById('backButton').classList.remove('hidden');
            document.getElementById('navigationInfo').textContent = `正在編輯 ${currentSection} 區域的詳細內容，中央為該區域的中心主題`;
            
            LEVEL2_ORDER.forEach(pos => {
                const cell = document.createElement('div');
                
                if (pos === 'CENTER') {
                    cell.className = 'grid-cell ring-cell';
                    const content = projectData[currentProject]?.sections?.[currentSection]?.center?.content || '';
                    cell.innerHTML = `
                        <div class="cell-label ring-label">${currentSection}</div>
                        <textarea class="cell-content" placeholder="${currentSection} 區域中心..." 
                                  onchange="updateContent('section', '${currentSection}', this.value)">${content}</textarea>
                    `;
                } else {
                    cell.className = 'grid-cell detail-cell';
                    const detailData = projectData[currentProject]?.sections?.[currentSection]?.details?.[pos];
                    const content = detailData?.content || '';
                    cell.innerHTML = `
                        <div class="cell-label detail-label">${pos}</div>
                        <textarea class="cell-content" placeholder="詳細內容..." 
                                  onchange="updateContent('detail', '${currentSection}.${pos}', this.value)">${content}</textarea>
                    `;
                }
                
                grid.appendChild(cell);
            });
        }
        
        // 進入第二層
        function enterLevel2(section) {
            currentLevel = 2;
            currentSection = section;
            renderMandala();
            updateBreadcrumb();
        }
        
        // 返回第一層
        function goBackToLevel1() {
            currentLevel = 1;
            currentSection = null;
            renderMandala();
            updateBreadcrumb();
        }
        
        // 更新內容
        function updateContent(type, key, value) {
            if (!currentProject || !projectData[currentProject]) return;
            
            if (type === 'center') {
                projectData[currentProject].center.content = value;
            } else if (type === 'section') {
                if (!projectData[currentProject].sections[key]) {
                    projectData[currentProject].sections[key] = { center: { content: '' }, details: {} };
                }
                projectData[currentProject].sections[key].center.content = value;
            } else if (type === 'detail') {
                const [section, detail] = key.split('.');
                if (!projectData[currentProject].sections[section].details[detail]) {
                    projectData[currentProject].sections[section].details[detail] = { content: '' };
                }
                projectData[currentProject].sections[section].details[detail].content = value;
            }
            
            // 標記為需要同步
            markProjectForSync(currentProject);
            
            // 自動儲存到本地
            saveToLocalStorage();
        }
        
        // 更新麵包屑
        function updateBreadcrumb() {
            const breadcrumb = document.getElementById('breadcrumb');
            if (currentProject) {
                const config = PROJECT_CONFIG[currentProject];
                let text = `${config.chapter} 系列 > ${currentProject} ${config.name}`;
                if (currentLevel === 2) {
                    text += ` > ${currentSection} 區域`;
                }
                breadcrumb.textContent = text;
            }
        }
        
        // Sidebar 切換
        function toggleSidebar() {
            sidebarVisible = !sidebarVisible;
            updateSidebarVisibility();
        }
        
        function updateSidebarVisibility() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            
            if (window.innerWidth < 1024) {
                // 移動設備
                if (sidebarVisible) {
                    sidebar.classList.remove('hidden');
                } else {
                    sidebar.classList.add('hidden');
                }
                mainContent.classList.add('expanded');
            } else {
                // 桌面設備
                if (sidebarVisible) {
                    sidebar.classList.remove('hidden');
                    mainContent.classList.remove('expanded');
                } else {
                    sidebar.classList.add('hidden');
                    mainContent.classList.add('expanded');
                }
            }
        }
        
        // GitHub 功能
        function showGitHubSetup() {
            document.getElementById('githubModal').classList.remove('hidden');
            document.getElementById('githubToken').value = githubToken;
        }
        
        function closeGitHubModal() {
            document.getElementById('githubModal').classList.add('hidden');
        }
        
        function connectGitHub() {
            const token = document.getElementById('githubToken').value.trim();
            if (!token) {
                alert('請輸入GitHub Personal Access Token');
                return;
            }
            
            githubToken = token;
            localStorage.setItem('github_token', token);
            
            // 測試連接
            testGitHubConnection().then(success => {
                if (success) {
                    updateGitHubStatus(true);
                    closeGitHubModal();
                    alert('GitHub連接成功！');
                } else {
                    alert('GitHub連接失敗，請檢查Token是否正確');
                }
            });
        }
        
        async function testGitHubConnection() {
            try {
                const response = await fetch('https://api.github.com/user', {
                    headers: {
                        'Authorization': `token ${githubToken}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                return response.ok;
            } catch (error) {
                return false;
            }
        }
        
        function checkGitHubConnection() {
            if (githubToken) {
                testGitHubConnection().then(success => {
                    updateGitHubStatus(success);
                });
            }
        }
        
        function updateGitHubStatus(connected) {
            const statusText = document.getElementById('githubStatusText');
            const statusIcon = document.getElementById('githubSyncStatus');
            
            if (connected) {
                statusText.textContent = '已連接GitHub';
                statusIcon.className = 'sync-status synced';
            } else {
                statusText.textContent = '未連接GitHub';
                statusIcon.className = 'sync-status offline';
            }
        }
        
        // 標記專案需要同步
        function markProjectForSync(projectId) {
            const projectItem = document.querySelector(`[data-project="${projectId}"] .sync-status`);
            if (projectItem) {
                projectItem.className = 'sync-status syncing';
            }
        }
        
        // 儲存專案
        async function saveProject() {
            if (!currentProject) {
                alert('請先選擇一個專案');
                return;
            }
            
            updateSyncStatus('syncing', '同步中...');
            
            try {
                // 保存到本地
                saveToLocalStorage();
                
                // 如果有GitHub Token，同步到雲端
                if (githubToken) {
                    await saveProjectToCloud(currentProject);
                    updateSyncStatus('synced', '已同步');
                    updateProjectSyncStatus(currentProject, 'synced');
                } else {
                    updateSyncStatus('offline', '僅本機儲存');
                }
                
                alert('專案已儲存');
            } catch (error) {
                console.error('儲存失敗:', error);
                updateSyncStatus('error', '同步失敗');
                alert('儲存失敗: ' + error.message);
            }
        }
        
        // 載入專案
        async function loadProject() {
            if (!currentProject) {
                alert('請先選擇一個專案');
                return;
            }
            
            try {
                if (githubToken) {
                    // 從雲端載入
                    await loadProjectFromCloud(currentProject);
                    renderMandala();
                    alert('已從雲端載入最新資料');
                } else {
                    // 從本地載入
                    loadProjectsFromLocalStorage();
                    renderMandala();
                    alert('已從本機載入資料');
                }
            } catch (error) {
                console.error('載入失敗:', error);
                alert('載入失敗: ' + error.message);
            }
        }
        
        // 雲端儲存
        async function saveProjectToCloud(projectId) {
            const gistData = projectDataToOPML(projectId);
            const gistId = localStorage.getItem(`gist_${projectId}`);
            
            const config = PROJECT_CONFIG[projectId];
            const fileName = `mandala_${projectId}_${config.name}.opml`;
            
            const gistPayload = {
                description: `曼陀羅專案: ${projectId} ${config.name}`,
                files: {
                    [fileName]: {
                        content: gistData
                    }
                }
            };
            
            let url = 'https://api.github.com/gists';
            let method = 'POST';
            
            if (gistId) {
                url = `https://api.github.com/gists/${gistId}`;
                method = 'PATCH';
            }
            
            const response = await fetch(url, {
                method: method,
                headers: {
                    'Authorization': `token ${githubToken}`,
                    'Accept': 'application/vnd.github.v3+json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(gistPayload)
            });
            
            if (!response.ok) {
                throw new Error(`GitHub API error: ${response.status}`);
            }
            
            const result = await response.json();
            
            if (!gistId) {
                localStorage.setItem(`gist_${projectId}`, result.id);
            }
        }
        
        // 從雲端載入
        async function loadProjectFromCloud(projectId) {
            const gistId = localStorage.getItem(`gist_${projectId}`);
            if (!gistId) return;
            
            try {
                const response = await fetch(`https://api.github.com/gists/${gistId}`, {
                    headers: {
                        'Authorization': `token ${githubToken}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (!response.ok) return;
                
                const gist = await response.json();
                const fileName = Object.keys(gist.files)[0];
                const content = gist.files[fileName].content;
                
                // 解析OPML並更新專案數據
                parseOPMLToProject(content, projectId);
                updateProjectSyncStatus(projectId, 'synced');
            } catch (error) {
                console.error('從雲端載入失敗:', error);
            }
        }
        
        // 更新同步狀態
        function updateSyncStatus(status, text) {
            const statusIcon = document.getElementById('syncStatusIcon');
            const statusText = document.getElementById('syncStatusText');
            
            statusIcon.className = `sync-status ${status}`;
            statusText.textContent = text;
        }
        
        // 更新專案同步狀態
        function updateProjectSyncStatus(projectId, status) {
            const projectItem = document.querySelector(`[data-project="${projectId}"] .sync-status`);
            if (projectItem) {
                projectItem.className = `sync-status ${status}`;
            }
        }
        
        // 本機儲存
        function saveToLocalStorage() {
            localStorage.setItem('mandala_projects', JSON.stringify(projectData));
            localStorage.setItem('mandala_last_updated', new Date().toISOString());
        }
        
        function loadProjectsFromLocalStorage() {
            const saved = localStorage.getItem('mandala_projects');
            if (saved) {
                try {
                    const loadedData = JSON.parse(saved);
                    projectData = { ...projectData, ...loadedData };
                } catch (error) {
                    console.error('載入本機資料失敗:', error);
                }
            }
        }
        
        // OPML 匯出/匯入
        function exportCurrentOPML() {
            if (!currentProject) {
                alert('請先選擇一個專案');
                return;
            }
            
            const opmlContent = projectDataToOPML(currentProject);
            const config = PROJECT_CONFIG[currentProject];
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, 16);
            const fileName = `mandala_${currentProject}_${config.name}_${timestamp}.opml`;
            
            downloadFile(opmlContent, fileName);
        }
        
        function projectDataToOPML(projectId) {
            const config = PROJECT_CONFIG[projectId];
            const data = projectData[projectId];
            
            let opml = `<?xml version="1.0" encoding="UTF-8"?>
<opml version="2.0">
    <head>
        <title>曼陀羅專案: ${projectId} ${config.name}</title>
    </head>
    <body>
        <outline text="中心: ${escapeXml(data.center?.content || '')}">`;
            
            ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'].forEach(letter => {
                const section = data.sections?.[letter];
                opml += `
            <outline text="${letter}: ${escapeXml(section?.center?.content || '')}">`;
                
                ['1', '2', '3', '4', '5', '6', '7', '8'].forEach(num => {
                    const detail = section?.details?.[num];
                    opml += `
                <outline text="${num}: ${escapeXml(detail?.content || '')}"/>`;
                });
                
                opml += `
            </outline>`;
            });
            
            opml += `
        </outline>
    </body>
</opml>`;
            
            return opml;
        }
        
        function parseOPMLToProject(opmlContent, projectId) {
            const parser = new DOMParser();
            const doc = parser.parseFromString(opmlContent, 'text/xml');
            
            const rootOutline = doc.querySelector('body > outline');
            if (!rootOutline) return;
            
            // 解析中心內容
            const rootText = rootOutline.getAttribute('text') || '';
            const centerContent = rootText.replace(/^中心:\s*/, '');
            
            if (!projectData[projectId]) {
                projectData[projectId] = createEmptyMandala();
            }
            
            projectData[projectId].center.content = centerContent;
            
            // 解析各區域
            const sectionNodes = rootOutline.querySelectorAll(':scope > outline');
            sectionNodes.forEach(sectionNode => {
                const sectionText = sectionNode.getAttribute('text') || '';
                const [letter, sectionContent] = sectionText.split(':');
                const sectionKey = letter.trim();
                
                if (/^[A-H]$/.test(sectionKey)) {
                    if (!projectData[projectId].sections[sectionKey]) {
                        projectData[projectId].sections[sectionKey] = { center: { content: '' }, details: {} };
                    }
                    
                    projectData[projectId].sections[sectionKey].center.content = (sectionContent || '').trim();
                    
                    // 解析詳細內容
                    const detailNodes = sectionNode.querySelectorAll(':scope > outline');
                    detailNodes.forEach(detailNode => {
                        const detailText = detailNode.getAttribute('text') || '';
                        const [num, detailContent] = detailText.split(':');
                        const numKey = num.trim();
                        
                        if (/^[1-8]$/.test(numKey)) {
                            if (!projectData[projectId].sections[sectionKey].details[numKey]) {
                                projectData[projectId].sections[sectionKey].details[numKey] = { content: '' };
                            }
                            projectData[projectId].sections[sectionKey].details[numKey].content = (detailContent || '').trim();
                        }
                    });
                }
            });
            
            saveToLocalStorage();
        }
        
        function importOPML() {
            document.getElementById('fileInput').click();
        }
        
        function handleFileImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    if (!currentProject) {
                        alert('請先選擇一個專案進行匯入');
                        return;
                    }
                    
                    parseOPMLToProject(e.target.result, currentProject);
                    renderMandala();
                    alert('OPML 匯入成功！');
                } catch (error) {
                    alert('匯入失敗: 檔案格式不正確');
                }
            };
            reader.readAsText(file);
        }
        
        // 清除功能
        function clearCurrentLevel() {
            if (!currentProject) return;
            
            let message = '';
            if (currentLevel === 1) {
                message = '確定要清除第一層的 A-H 區域內容嗎？（不包括各區域的詳細內容）';
            } else {
                message = `確定要清除 ${currentSection} 區域的 1-8 詳細內容嗎？（不包括區域中心）`;
            }
            
            if (!confirm(message)) return;
            
            if (currentLevel === 1) {
                // 清除 A-H 區域的中心內容
                ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H'].forEach(letter => {
                    if (projectData[currentProject].sections[letter]) {
                        projectData[currentProject].sections[letter].center.content = '';
                    }
                });
            } else {
                // 清除當前區域的 1-8 詳細內容
                if (projectData[currentProject].sections[currentSection]) {
                    ['1', '2', '3', '4', '5', '6', '7', '8'].forEach(num => {
                        if (projectData[currentProject].sections[currentSection].details[num]) {
                            projectData[currentProject].sections[currentSection].details[num].content = '';
                        }
                    });
                }
            }
            
            renderMandala();
            saveToLocalStorage();
            markProjectForSync(currentProject);
        }
        
        function clearEntireMandala() {
            if (!currentProject) return;
            
            const config = PROJECT_CONFIG[currentProject];
            const message = `⚠️ 確定要清除整個「${currentProject} ${config.name}」曼陀羅的所有內容嗎？\n\n此操作將清除：\n- 中心主題\n- 所有 A-H 區域內容\n- 所有詳細內容 (1-8)\n\n此操作無法復原！`;
            
            if (!confirm(message)) return;
            
            // 重置整個專案
            projectData[currentProject] = createEmptyMandala();
            
            renderMandala();
            saveToLocalStorage();
            markProjectForSync(currentProject);
            
            alert('曼陀羅已清除完成');
        }
        
        // 工具函數
        function escapeXml(str) {
            if (!str) return '';
            return str.replace(/[&<>"']/g, function(match) {
                const escapeMap = {
                    '&': '&amp;',
                    '<': '&lt;',
                    '>': '&gt;',
                    '"': '&quot;',
                    "'": '&apos;'
                };
                return escapeMap[match];
            });
        }
        
        function downloadFile(content, fileName) {
            const blob = new Blob([content], { type: 'text/xml' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // 固定網址部署相關
        function showDeployModal() {
            document.getElementById('deployModal').classList.remove('hidden');
        }
        
        function closeDeployModal() {
            document.getElementById('deployModal').classList.add('hidden');
        }
        
        function downloadHTML() {
            // 獲取當前頁面的HTML內容
            const htmlContent = document.documentElement.outerHTML;
            downloadFile(htmlContent, 'mandala_system.html');
            alert('HTML檔案已下載，您可以部署到任何伺服器獲得固定網址！');
        }
    </script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"9789df3c5ef47d1b","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.8.0","token":"4edd5f8ec12a48cfa682ab8261b80a79"}' crossorigin="anonymous"></script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDpSqVKo6qAeAi7LETwLVXyDZMHIMjbI1ka%2FPLM0saSZwTcot2Wy1haxSSPhHmIn5WZWBTwmuXGsVNR7ZvPVLkjY%2FY4ZvZnw6IZjGi4zVwtp89B05hXGOVuDYOIMwDk37JSMlSXj4Xah0UOkEHV1hZsk32Go5DUpNucxpNR0fVhWa6gxD49jyFfUNvAGie87agei6l7px68ExTf1JG1h5N%2FkBhdHEPrc%2FtkcpNayn0M4BJ86yLVp0c7CyE2PUf%2FM0WCLkRdg9bw5QbQR6W37BVKGuhgUksid0CsSNJmbwAfrFnhPEfNXGM7q2Rs8k04f4pGaps40gApJBcKnoEb%2FBEIY4OnSzsqOSeKZWi8O3drpOXQVcauIHRf3RxzSkUpLCnb3ikqyYKTTmqllNCUzMcJ3T8nJ%2FXGKa2N7qZDS7yNGrR%2B4IJyXMDrVwy5e%2BrpU80X5%2B7PHqjX%2Bl8lJEmyVZa%2FIky3ofKRadhqRHxRsphPg9iYJwQMQ74lz4fsN98dXl%2B1G967mGeLXXmfRshSloNOM%3D";
        window.__genspark_locale = "zh-TW";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDpSqVKo6qAeAi7LETwLVXyDZMHIMjbI1ka/PLM0saSZwTcot2Wy1haxSSPhHmIn5WZWBTwmuXGsVNR7ZvPVLkjY/Y4ZvZnw6IZjGi4zVwtp89B05hXGOVuDYOIMwDk37JSMlSXj4Xah0UOkEHV1hZsk32Go5DUpNucxpNR0fVhWa6gxD49jyFfUNvAGie87agei6l7px68ExTf1JG1h5N/kBhdHEPrc/tkcpNayn0M4BJ86yLVp0c7CyE2PUf/M0WCLkRdg9bw5QbQR6W37BVKGuhgUksid0CsSNJmbwAfrFnhPEfNXGM7q2Rs8k04f4pGaps40gApJBcKnoEb/BEIY4OnSzsqOSeKZWi8O3drpOXQVcauIHRf3RxzSkUpLCnb3ikqyYKTTmqllNCUzMcJ3T8nJ/XGKa2N7qZDS7yNGrR+4IJyXMDrVwy5e+rpU80X5+7PHqjX+l8lJEmyVZa/Iky3ofKRadhqRHxRsphPg9iYJwQMQ74lz4fsN98dXl+1G967mGeLXXmfRshSloNOM=";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    